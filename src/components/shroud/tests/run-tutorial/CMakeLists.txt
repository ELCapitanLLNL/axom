#
# run-tutorial - A test program to use the tutorial examples
#

include_directories(.)  # needed by ../tutorial files

blt_add_executable(
    NAME shroud-run-tutorial
    SOURCES
        main.f
        # The 'library' to wrap
        tutorial.cpp
        # Files generated by shroud
        ../tutorial/wrapftutorial.f
        ../tutorial/wrapTutorial.cpp
        ../tutorial/wrapClass1.cpp
        ../tutorial/shroudrt.cpp
    DEPENDS_ON fruit
    OUTPUT_DIR ${TEST_OUTPUT_DIRECTORY}
)
blt_add_test(
    NAME shroud-run-tutorial
    COMMAND shroud-run-tutorial
)

#
# Make Python module library
#
#if(PYTHONINTERP_FOUND)
if(ENABLE_PYTHON_API)
    blt_add_python_module(
        NAME
            tutorial
        SOURCES
            tutorial.cpp
            # Files generated by shroud
            ../tutorial/pyClass1type.cpp
            ../tutorial/pyTutorialmodule.cpp
            ../tutorial/pyTutorialhelper.cpp
        OUTPUT_DIR
            ${CMAKE_CURRENT_BINARY_DIR}/python
    )
    add_test (
        NAME shroud-run-tutorial-python
        COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/python/test.py
        WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/python
    )
    set_tests_properties(shroud-run-tutorial-python PROPERTIES
        ENVIRONMENT PYTHONPATH=${CMAKE_CURRENT_BINARY_DIR}/python)
endif()
