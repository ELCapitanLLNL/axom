#
# run-tutorial - A test program to use the tutorial examples
#

include_directories(.)  # needed by ../tutorial files

blt_add_executable(
    NAME shroud-run-tutorial
    SOURCES
        main.f
        # The 'library' to wrap
        tutorial.cpp
        # Files generated by shroud
        ../tutorial/wrapftutorial.f
        ../tutorial/wrapTutorial.cpp
        ../tutorial/wrapClass1.cpp
        ../tutorial/shroudrt.cpp
    DEPENDS_ON fruit
    OUTPUT_DIR ${TEST_OUTPUT_DIRECTORY}
)
blt_add_test(
    NAME shroud-run-tutorial
    COMMAND shroud-run-tutorial
)

#
# Make Python module library
#
if(ENABLE_PYTHON_API)
    include_directories(${PYTHON_INCLUDE_DIRS})

    make_library(
        NAME
            tutorial
        SOURCES
            tutorial.cpp
            # Files generated by shroud
            ../tutorial/pyClass1type.cpp
	        ../tutorial/pyTutorialmodule.cpp
            ../tutorial/pyTutorialhelper.cpp
    )

    # Python wants the name to be tutorial.so
    set_target_properties(tutorial
        PROPERTIES
          PREFIX ""
    )

#    add_custom_command(
#        TARGET tutorial POST_BUILD
#        WORKING_DIRECTORY ${LIBRARY_OUTPUT_PATH}
#        COMMAND ln -sf libtutorial.so tutorial.so
#    )

endif(ENABLE_PYTHON_API)
