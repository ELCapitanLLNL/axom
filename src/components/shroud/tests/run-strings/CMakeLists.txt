#
# run-strings - A test program to use the strings examples
#

include_directories(.)  # needed by ../strings files

blt_add_executable(
    NAME  shroud-run-strings
    SOURCES
        main.f
        # The 'library' to wrap
        strings.cpp
        # Files generated by shroud
        ../strings/wrapfstrings.f
        ../strings/wrapstrings.cpp
    DEPENDS_ON fruit
    OUTPUT_DIR ${TEST_OUTPUT_DIRECTORY}
)
blt_add_test(
    NAME shroud-run-strings
    COMMAND shroud-run-strings
)

#
# Make Python module library
#
if(ENABLE_PYTHON_API)
    include_directories(${PYTHON_INCLUDE_DIRS})

    make_library(
        NAME
            strings
        SOURCES
            strings.cpp
            # Files generated by shroud
            ../strings/pyClass1type.cpp
            ../strings/pyStringsmodule.cpp
            ../strings/pyStringshelper.cpp
            ../strings/shroudrt.cpp
    )

    # Python wants the name to be strings.so
    set_target_properties(strings
        PROPERTIES
          PREFIX ""
    )

#    add_custom_command(
#        TARGET strings POST_BUILD
#        WORKING_DIRECTORY ${LIBRARY_OUTPUT_PATH}
#        COMMAND ln -sf libstrings.so strings.so
#    )

endif(ENABLE_PYTHON_API)
