###############################################################################
# Copyright (c) 2017, Lawrence Livermore National Security, LLC.
#
# Produced at the Lawrence Livermore National Laboratory
#
# LLNL-CODE-xxxxxx
#
# All rights reserved.
#
# This file is part of Axom.
#
# For details about use and distribution, please read axom/LICENSE.
#
##############################################################################

set(quest_example_depends
        axom_utils
        slic
        mint
        slam
        quest
        )

if (BOOST_FOUND)
    list(APPEND quest_example_depends boost)
endif()

if (ENABLE_OPENMP)
    list(APPEND quest_example_depends openmp)
endif()

blt_add_executable(
    NAME        quest_distance_driver_ex
    SOURCES     distance_driver.cpp
    OUTPUT_DIR  ${EXAMPLE_OUTPUT_DIRECTORY}
    DEPENDS_ON  ${quest_example_depends}
    )

blt_add_executable(
    NAME        quest_sphere_distance_ex
    SOURCES     sphere_distance.cpp
    OUTPUT_DIR  ${EXAMPLE_OUTPUT_DIRECTORY}
    DEPENDS_ON  ${quest_example_depends}
    )

blt_add_executable(
    NAME        quest_containment_driver_ex
    SOURCES     containment_driver.cpp
    OUTPUT_DIR  ${EXAMPLE_OUTPUT_DIRECTORY}
    DEPENDS_ON  ${quest_example_depends} fmt
    )

## Quest interface examples

set(quest_interface_extra_depends)
if (ENABLE_LUMBERJACK)
    list(APPEND quest_interface_extra_depends lumberjack)
endif()

blt_add_executable(
    NAME        quest_interface_ex
    SOURCES     quest_interface.cpp
    OUTPUT_DIR  ${EXAMPLE_OUTPUT_DIRECTORY}
    DEPENDS_ON  ${quest_example_depends} ${quest_interface_extra_depends}
    )

# Add a test for the quest interface.  Set up for MPI, when available
set(quest_data_dir  ${CMAKE_CURRENT_SOURCE_DIR}/../data)
if (ENABLE_MPI)
    blt_add_test(
        NAME quest_interface_mpi_test
        COMMAND quest_interface_ex ${quest_data_dir}/sphere_binary.stl
        NUM_MPI_TASKS 2
        )
else()
    blt_add_test(
        NAME quest_interface_test
        COMMAND quest_interface_ex ${quest_data_dir}/sphere_binary.stl
        )
endif()


# The quest fortran API depends on MPI
if (ENABLE_MPI AND ENABLE_FORTRAN)
    blt_add_executable(
        NAME        quest_interface_F_ex
        SOURCES     quest_interface_fortran.F
        OUTPUT_DIR  ${EXAMPLE_OUTPUT_DIRECTORY}
        DEPENDS_ON  ${quest_example_depends} ${quest_interface_extra_depends}
        )

    set_target_properties(quest_interface_F_ex
                          PROPERTIES LINKER_LANGUAGE Fortran)

endif()
