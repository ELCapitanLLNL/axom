This version is multi-material and runs on arbitrary polygons in XY.
